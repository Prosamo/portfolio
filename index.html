<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prosamo's Portfolio</title>
    <script src="./src/typehandler.js" defer></script>
    <script src="./src/keyboard.js" defer></script>
    <link rel="stylesheet" href="./src/portfolio.css">
</head>
<body>
    <div class="fixed-background"></div>
    <header>
        <div class="split-image"></div>
        <nav>
            <ul>
                <li><a href="#about">About Me</a></li>
                <li><a href="#projects">Projects</a></li>
                <li><a href="#accounts">My Accounts</a></li>
            </ul>
        </nav>
    </header>
    <section id="about" class="scroll-element">
        <h2>About Me</h2>
        <img src="./img/aboutme.png" style="width: 100%; max-width: 500px; height: auto; display: block; margin: 0 auto;">
        <div style="margin-top:30px; margin:0, auto; background: none;">
            <div class="Display" id="inputDisplay" style="color:#008888; text-shadow: 0.5px 0.5px 1px #0080c0,-0.5px -0.5px 1px #0080c0,0.5px -0.5px 1px #0080c0,-0.5px 0.5px 1px #0080c0;"></div>
            <div class="Display" id="sentenceDisplay"></div>
            <div class="keyboard" id="keyboard" style="margin-top: 20px;"></div>
        </div>
        
    </section>
    <section id="projects" class="scroll-element">
        <h2>Projects</h2>
        <div class="scroll-element project">
            <a href="https://prosamo.github.io/tank-game"><img src="./img/tank.png" style="opacity: 90%; background: radial-gradient(#16dfdf00 , #16dfdf);"></a>
            <div class="screen">　pygameで作ったシンプルなゲームです。シューティングゲームに方向を導入することで、簡単に組める範疇でも、ある程度のゲーム性を追求しました。また、弾を5発消費すると、ビームを撃てるようにしてあるのですが、こちらはゲーム性の向上だけでなく、画面を揺らす演出などのこだわりポイントがあります。画像を押すとゲームのリンクに飛べるので、ぜひプレイしてみてください。（スマートフォンでのプレイをお勧めします）</div>
        </div>
        <div class="scroll-element project">
            <a href="https://prosamo.github.io/wind_typing"><img src="./img/typing.png" style="opacity: 90%; background: radial-gradient(#16dfdf00 , #16dfdf);"></a>
            <div class="screen">　pygameで作ったタイピングゲームです。後ほど紹介しますが、タイピングゲームの処理部分を全て行うモジュールを自作したので、処理は全て流用です。このゲームは、自分でお題を決めてタイピングゲームがしたいという単純な目的で作ったものです。ただし、公開にあたって何かしらの差別化をしたいと考え、「瞬間のタイピング速度」という概念を導入しました。強風というコンセプトに上手く落とし込む都合上、直接この数値をリザルトには表示していませんが、最大瞬間風速というのが、「瞬間のタイピング速度」の2倍の値に設定してあります。こちらもぜひプレイして確かめて下さい。</div>
        </div>   
        <div class="scroll-element project">
            <a href="https://qiita.com/Prosamo/items/de12a90ba026b7517d2a"><img src="./img/pygbag.png" style="opacity: 90%; background: radial-gradient(#16dfdf00 , #16dfdf);"></a>
            <div class="screen">　上記のゲームは、pygbagというモジュールを使って公開したものです。海外の人が作ったものなので、日本ではあまり知名度がありません。そのため、使い方のガイドも全て英語の文献を読みました。その過程をまとめ、おそらく日本初のpygbagの使い方を解説した記事が、この画像のものになります。</div>
        </div>        <div class="scroll-element project">
            <a href="https://pypi.org/project/typehandler"><img src="./img/typehandler.png" style="opacity: 90%; background: radial-gradient(#16dfdf00 , #16dfdf);"></a>
            <div class="screen">　タイピングゲームを簡単に実装するためのPythonモジュールです。日本語、英数字、記号に対応しています。2025年中にDL数10000を目指し、アップデートと宣伝を続けています。機能を追加していく上で、自分向けのツールとは違った点を意識する機会となりました。以前までのバージョンと互換性を持たせるため、メソッドの変更で安易に引数を変更しないようにしたり、処理の部分をプライベートメソッドとし、エラーハンドリングを付けたものをユーザーに提供する工夫をしました。
            </div>
        </div>    
        </section>
    <section id="accounts" class="scroll-element">
        <h2>My Accounts</h2>
        <a href="https://qiita.com/Prosamo"><img src="./img/qiita.png" style="width: 100%; max-width: 500px; height: auto; display: inline-block; margin: 0 auto;"></a>
        <a href="https://github.com/Prosamo"><img src="./img/github.png" style="width: 100%; max-width: 500px; height: auto; display: inline-block; margin: 0 auto;"></a>
        <a href="https://x.com/prosamo314"><img src="./img/x.png" style="width: 100%; max-width: 500px; height: auto; display: inline-block; margin: 0 auto;"></a>
    </section>
    <footer>
        <p>&copy; 2025 Prosamo. All rights reserved.</p>
    </footer>
    
    <script>
        setTimeout(() => {
            document.querySelector('.split-image').classList.add('animate');
        }, 1000); /* 1秒後にクラスを追加 */

        document.addEventListener("DOMContentLoaded", function() {
            var scrollElements = document.querySelectorAll(".scroll-element");
            var elementInView = (el, dividend = 1) => {
                const elementTop = el.getBoundingClientRect().top;
                return (
                    elementTop <= 
                    (window.innerHeight || document.documentElement.clientHeight) / dividend
                );
            };
            var displayScrollElement = (element) => {
                element.classList.add("scrolled");
            };
            var handleScrollAnimation = () => {
                scrollElements.forEach((el) => {
                    if (elementInView(el, 1.25)) {
                        displayScrollElement(el);
                    }
                });
            };
            window.addEventListener("scroll", () => {
                handleScrollAnimation();
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            words = {
                'ポートフォリオをご覧いただきありがとうございます':'ぽーとふぉりおをごらんいただきありがとうございます',
                'ただ見るだけではワクワクしないと思うので':'ただみるだけではわくわくしないとおもうので',
                'タイピングゲームを用意いたしました':'たいぴんぐげーむをよういいたしました',
                '私はPythonをメインに学習していますが':'わたしはPythonをめいんにがくしゅうしていますが',
                'ポートフォリオに埋め込むため、JavaScriptで実装してみました':'ぽーとふぉりおにうめこむため,JavaScriptでじっそうしてみました',
                'タイピングゲームは、私がよく扱うテーマです':'たいぴんぐげーむは,わたしがよくあつかうてーまです',
                '寿司打というゲームで１位を取ったことがきっかけで':'すしだというげーむで1いをとったことがきっかけで',
                'タイピングゲーム開発用のモジュールをPyPIで公開したため':'たいぴんぐげーむかいはつようのもじゅーるをPyPIでこうかいしたため',
                'その宣伝のために、タイピングゲームを作ることが増えました':'そのせんでんのために,たいぴんぐげーむをつくることがふえました',
                'タイピングゲームに限らず、ゲームはよく扱っています':'たいぴんぐげーむにかぎらず,げーむはよくあつかっています',
                'リンクを貼ってあるので':'りんくをはってあるので',
                '詳しくはこのページのProjectsをご覧ください':'くわしくはこのぺーじのProjectsをごらんください'
            };
            const process = new Process(words);
            const keyboardElement = document.getElementById('keyboard');
            const keyboard = new Keyboard(keyboardElement);
            
            const inputDisplay = document.getElementById('inputDisplay');
            const sentenceDisplay = document.getElementById('sentenceDisplay');
            process.updateShowRoman();
            inputDisplay.textContent = process.showRoman;
            sentenceDisplay.textContent = process.sentence;

            document.addEventListener('keydown', (event) => {
                event.preventDefault();
                keyboard.shiftFixed = false;
                const key = event.key;
                const shift = event.shiftKey;

                keyboard.updateKeyboard(shift);
                const result = process.main(key, keyboard.isShiftActive);

                if (result || key === 'Shift') {
                    keyboard.highlightKey(key);
                } else {
                    keyboard.missHighlightKey(key);
                };

                process.updateShowRoman();
                sentenceDisplay.textContent = process.sentence;
                
                //進行度が分かるように色分けして表示
                const roman = process.showRoman;
                const input = process.input;

                let resultHTML = '';

                const minLength = Math.min(roman.length, input.length);
                let match = true;

                for (let i = 0; i < minLength; i++) {
                    if (roman[i] === input[i] && match) {
                        resultHTML += `<span class="match">${roman[i]}</span>`;
                    } else {
                        match = false;
                        resultHTML += `<span class="mismatch">${roman[i]}</span>`;
                    }
                }

                // 文字列1が文字列2よりも長い場合、残りの文字を追加
                if (roman.length > minLength) {
                    resultHTML += `<span class="mismatch">${roman.slice(minLength)}</span>`;
                }

                inputDisplay.innerHTML = resultHTML;
            });
            document.addEventListener('keyup', (event) => {
                const shift = event.shiftKey;
                if (shift){
                    keyboard.updateKeyboard(true);
                } else{
                    keyboard.updateKeyboard(false);
                };
            });

            // カスタムイベントを受け取る
            document.addEventListener('keyPressed', (event) => {
                const key = event.detail;
                const result = process.main(key, keyboard.isShiftActive);

                if (result || key === 'Shift') {
                    keyboard.highlightKey(key);
                } else {
                    keyboard.missHighlightKey(key);
                };

                process.updateShowRoman();
                sentenceDisplay.textContent = process.sentence;

                //進行度が分かるように色分けして表示
                const roman = process.showRoman;
                const input = process.input;

                let resultHTML = '';

                const minLength = Math.min(roman.length, input.length);
                let match = true;

                for (let i = 0; i < minLength; i++) {
                    if (roman[i] === input[i] && match) {
                        resultHTML += `<span class="match">${roman[i]}</span>`;
                    } else {
                        match = false;
                        resultHTML += `<span class="mismatch">${roman[i]}</span>`;
                    }
                }

                // 文字列1が文字列2よりも長い場合、残りの文字を追加
                if (roman.length > minLength) {
                    resultHTML += `<span class="mismatch">${roman.slice(minLength)}</span>`;
                }

                inputDisplay.innerHTML = resultHTML;
            });
        });
    </script>
</body>
</html>
